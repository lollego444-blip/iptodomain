<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WMN2 | IP to Domain Converter</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,sans-serif;
      background:linear-gradient(135deg,#667eea,#764ba2);
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;color:#333
    }
    .container{max-width:900px;width:100%}
    .header{text-align:center;color:#fff;margin-bottom:25px}
    .header h1{font-size:2.6rem;font-weight:800}
    .header h2{font-weight:400;opacity:.9}
    .tagline{display:inline-block;margin-top:10px;background:rgba(255,255,255,.15);padding:8px 18px;border-radius:20px}
    .card{background:#fff;border-radius:20px;padding:30px;box-shadow:0 20px 60px rgba(0,0,0,.25)}
    textarea{width:100%;height:180px;padding:18px;border-radius:12px;border:2px solid #e2e8f0;font-family:monospace}
    textarea:focus{outline:none;border-color:#667eea}
    .info{display:flex;justify-content:space-between;margin-top:8px;color:#718096;font-size:.9rem}
    .buttons{display:flex;gap:15px;margin:25px 0}
    .btn{flex:1;padding:15px;border:none;border-radius:12px;font-weight:600;cursor:pointer}
    .btn-primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
    .btn-copy{background:linear-gradient(135deg,#48bb78,#38a169);color:#fff}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .loading{text-align:center;display:none}
    .spinner{width:45px;height:45px;border:4px solid #e2e8f0;border-top:4px solid #667eea;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 12px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .results{margin-top:25px;border-top:2px solid #e2e8f0;padding-top:20px}
    .stats{display:flex;gap:25px}
    .stat-number{font-size:1.6rem;font-weight:700;color:#667eea}
    .domains{margin-top:15px;background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:18px;max-height:350px;overflow-y:auto}
    .domain{background:#fff;border-left:4px solid #48bb78;border-radius:8px;padding:10px 15px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center}
    .domain span{font-family:monospace}
    .empty{text-align:center;color:#a0aec0}
    .toast{position:fixed;bottom:30px;right:30px;background:linear-gradient(135deg,#48bb78,#38a169);color:#fff;padding:14px 22px;border-radius:12px;opacity:0;transform:translateY(100px);transition:.3s}
    .toast.show{opacity:1;transform:translateY(0)}
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>WMN2 - Mohamed Hichy</h1>
    <h2>IP to Domain Converter</h2>
  </div>

  <div class="card">
    <textarea id="ipInput" placeholder="Paste IP addresses (one per line)"></textarea>
    <div class="info">
      <span id="ipCount">0 IPs</span>
      <span id="charCount">0 chars</span>
    </div>

    <div class="buttons">
      <button class="btn btn-primary" onclick="lookupIPs()"><i class="fas fa-search"></i> Lookup</button>
      <button class="btn btn-copy" id="copyBtn" onclick="copyDomainsOnly()" disabled><i class="fas fa-copy"></i> Copy Domains Only</button>
    </div>

    <div class="loading" id="loading"><div class="spinner"></div>Looking up domains...</div>

    <div class="results">
      <div class="stats">
        <div><div class="stat-number" id="domainCount">0</div>Domains</div>
        <div><div class="stat-number" id="ipProcessed">0</div>IPs</div>
      </div>

      <div class="domains" id="domainsBox">
        <div class="empty" id="empty">No results yet</div>
        <div id="domainsList"></div>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast">Copied</div>

<script>
const ipInput = document.getElementById('ipInput');
const ipCount = document.getElementById('ipCount');
const charCount = document.getElementById('charCount');
const domainsList = document.getElementById('domainsList');
const domainCount = document.getElementById('domainCount');
const ipProcessed = document.getElementById('ipProcessed');
const loading = document.getElementById('loading');
const empty = document.getElementById('empty');
const copyBtn = document.getElementById('copyBtn');
const toast = document.getElementById('toast');

ipInput.addEventListener('input', () => {
  const t = ipInput.value.trim();
  ipCount.textContent = `${t ? t.split(/\n+/).length : 0} IPs`;
  charCount.textContent = `${t.length} chars`;
});

function showToast(msg){toast.textContent=msg;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),2500)}

async function lookupIPs(){
  const ips = ipInput.value.trim().split(/\n+/).filter(Boolean);
  if(!ips.length){showToast('Enter IP addresses');return}

  domainsList.innerHTML='';
  empty.style.display='none';
  loading.style.display='block';
  copyBtn.disabled=true;

  let results=[];

  for(const ip of ips){
    try{
      const r = await fetch(`https://api.hackertarget.com/reversedns/?q=${ip}`);
      const text = await r.text();

      if(!text.includes('error') && !text.includes('No DNS')){
        text.split('\n').forEach(line => {
          const parts = line.trim().split(/\s+/);
          if(parts.length >= 2){
            results.push({ ip: parts[0], domain: parts[1] });
          }
        });
      }
    }catch(e){}
  }

  const unique = Object.values(
    results.reduce((acc, cur) => {
      acc[cur.domain] = cur;
      return acc;
    }, {})
  ).sort((a,b)=>a.domain.localeCompare(b.domain));

  loading.style.display='none';
  domainCount.textContent = unique.length;
  ipProcessed.textContent = ips.length;

  if(!unique.length){empty.style.display='block';return}

  domainsList.innerHTML = unique.map(d => `
    <div class="domain">
      <span data-domain="${d.domain}"><strong>${d.ip}</strong> ${d.domain}</span>
      <i class="fas fa-check" style="color:#38a169"></i>
    </div>
  `).join('');

  copyBtn.disabled=false;
  showToast(`${unique.length} domains found`);
}

function copyDomainsOnly(){
  const domains = [...document.querySelectorAll('[data-domain]')]
    .map(el => el.dataset.domain);

  if(!domains.length){showToast('Nothing to copy');return}

  navigator.clipboard.writeText(domains.join('\n'))
    .then(()=>showToast('Domains copied'));
}
</script>
</body>
</html>
